<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. 介绍 &mdash; Skbtrace v20120916 documentation</title>
    <link rel="stylesheet" href="../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '20120916',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Skbtrace v20120916 documentation"
          href="../static/opensearch.xml"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Skbtrace v20120916 documentation" href="../index.html" />
    <link rel="up" title="The Skbtace User Manual" href="index.html" />
    <link rel="next" title="2. 编译" href="building.html" />
    <link rel="prev" title="The Skbtace User Manual" href="index.html" />
    <link rel="shortcut icon" type="image/png" href="../static/py.png" />
 

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="building.html" title="2. 编译"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The Skbtace User Manual"
             accesskey="P">previous</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Skbtrace v20120916 documentation</a> &raquo;</li>

          <li><a href="index.html" accesskey="U">The Skbtace User Manual</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<span id="id1"></span><h1>1. 介绍<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>1.1. 动机<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<blockquote>
<p>我注意到blktrace对于文件系统、块子系统甚至内存管理子系统的开发者给予了非常大的帮助。但网络子系统的开发者就没有这么幸运了——虽然tcpdump非常好用，但通常他们还是要根据很有限的计数统计调查问题，甚至经常需要逐行的分析源代码去了解到底发生了什么问题。一个常见的工作流是：检查计数器 -&gt; 翻腾源代码 -&gt; 编译实验猜想 -&gt; 再次检查计数器 ...... 这个过程非常困难，也非常难于分享经验和报告问题。而且，许多用户对协议栈内部也没有足够的了解，难于准备汇报问题，我曾经见过一些“详细的问题报告”，但其实里面包括的有用信息并不多。</p>
<p>相对于存储子系统来说，网络子系统面对的外部设备的I/O速率更快，这意味着网络子系统对于性能非常敏感。实际上，已经有一些先行者在尝试解决这个问题，他们增加了更详细的性能计数器。例如，Web10G就实现了RFC4898，它可以提供很多基于单条TCP连接的统计信息。对于TCP协议栈的研究者和工程师都非常有帮助，Web10G是一个非常有用的项目。问题是，它有一定的性能消耗（在我的虚拟机里，netperf的TCP_STREAM测试大约会降低5% - 10%），而且缺少灵活性。</p>
</blockquote>
</div>
<div class="section" id="id3">
<h2>1.2. 目标<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<blockquote>
Skbtrace试图做到以下几点：</blockquote>
<ul>
<li><p class="first">提供一种能够支持各种协议的可扩展行为跟踪（trace）架构。</p>
</li>
<li><p class="first">可以在运行时打开或者关闭全部或者部分功能。关掉时，没有任何性能损耗。 这可以通过jump label (static key)的API做到。</p>
</li>
<li><p class="first">直接汇报协议栈的内部状态，而不是通过间接的计数器，这要比计数器更加直接和易于分析。</p>
</li>
<li><p class="first">除了提供基于报文的跟踪功能，也提供基于连接的跟踪功能。Skbtrace提供了BPF兼容的过滤机制，同时也可以使用“事件选项”过滤。</p>
</li>
<li><p class="first">提供灵活的跟踪事件过滤机制。因为协议栈产生的事件速率非常快，如果没有这种机制，我们就会淹没在数据的海洋中。</p>
<p>与blktrace类似，skbtrace也基于tracepoint基本架构和relay文件系统的。</p>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">1. 介绍</a><ul>
<li><a class="reference external" href="#id2">1.1. 动机</a></li>
<li><a class="reference external" href="#id3">1.2. 目标</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">The Skbtace User Manual</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="building.html"
                                  title="next chapter">2. 编译</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../sources/using/introduction.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="building.html" title="2. 编译"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The Skbtace User Manual"
             >previous</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Skbtrace v20120916 documentation</a> &raquo;</li>

          <li><a href="index.html" >The Skbtace User Manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2012, Li Yu.
    <br />
    Last updated on Sep 16, 2012.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>

  </body>
</html>